{% import "flowbite_jinja_htmx/controls/forms/button.jinja" as Button %}
{% import "flowbite_jinja_htmx/controls/tooltip.jinja" as Tooltip %}
{% import "flowbite_jinja_htmx/controls/spinner.jinja" as Spinner %}
{% import "pages/scc/scc_changes_card.jinja" as SccChangesCard %}



{% extends "layouts/stacked_layout.html" %}


{% block page_body %}

<div class="mx-auto flex flex-col items-center">

    <div class="lg:w-3/4">

        <div class="flex items-start justify-between">
            <h1 class="pb-4 text-3xl">
                Source Control
            </h1>
            <div class="flex items-start space-x-3">
                {{ Button.render(id="indicator-fetch", style="spinner", text="Loading...", class="htmx-indicator") }}
                {{ Button.render(id="refresh-json-btn", text="Refresh", style="primary", tooltip="Refresh local and remote git data.", additional_attribs="hx-get='/scc/fetch' hx-indicator='#indicator-fetch'") }}
                {{ Button.render(id="back-btn", text="Back", style="primary", additional_attribs="onclick='history.back()'") }}
            </div>
        </div>

        <div class="flex flex-col space-y-8">

            <div class="flex flex-col space-y-2">
                <div class="flex items-center space-x-2">
                    <p class="font-medium text-lg">Git Repository Path:</p>
                    <p class="font-light">{{ app_services.scc_service.repo_path }}</p>
                </div>

                <div class="flex items-center space-x-2">
                    <p class="font-medium text-lg">Active Branch:</p>
                    <p class="font-light">{{ app_services.scc_service.active_branch_name }}</p>
                </div>


                
                
            </div>

            {% if app_services.scc_service.is_valid %}

                <div hx-get="/scc/changes" hx-swap="outerHTML" hx-indicator='#indicator-changes' hx-trigger="load">
                    <div id="indicator-changes" class="htmx-indicator">
                        <div class="flex flex-col space-y-3 pb-10">
                            <div class="text-xl">{{ space_name }}</div>
                            {{ Button.render(style="spinner", text="Loading...") }}
                        </div>
                    </div>
                </div>

            {% endif %}


        </div>

    </div>

</div>

{% endblock %}

